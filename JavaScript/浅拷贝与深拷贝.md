æ¶‰åŠåˆ° JavaScript çš„å†…å­˜æ¨¡åž‹ã€æ•°æ®ç»“æž„ä»¥åŠæ‹·è´æœºåˆ¶ã€‚

---

## âœ… ä¸€ã€åŸºæœ¬ç±»åž‹ vs å¼•ç”¨ç±»åž‹

| ç±»åž‹   | ç¤ºä¾‹                                                                     | å­˜å‚¨ä½ç½®           | ç‰¹ç‚¹                 |
| ---- | ---------------------------------------------------------------------- | -------------- | ------------------ |
| åŸºæœ¬ç±»åž‹ | `Number`, `String`, `Boolean`, `null`, `undefined`, `Symbol`, `BigInt` | **æ ˆå†…å­˜ï¼ˆStackï¼‰** | å€¼å­˜å‚¨åœ¨æ ˆä¸­ï¼Œç›´æŽ¥è®¿é—®        |
| å¼•ç”¨ç±»åž‹ | `Object`, `Array`, `Function`, `Date`, `RegExp`, `Map`, `Set`          | **å †å†…å­˜ï¼ˆHeapï¼‰**  | æ ˆä¸­å­˜å‚¨åœ°å€ï¼ˆå¼•ç”¨ï¼‰ï¼Œå®žé™…æ•°æ®åœ¨å †ä¸­ |

### ðŸ“Œ ä¸¾ä¸ªä¾‹å­ï¼š

```js
let a = { name: 'Vue' };
let b = a;
b.name = 'React';
console.log(a.name); // "React" â—ï¼ˆæŒ‡å‘åŒä¸€å†…å­˜åœ°å€ï¼‰
```

è¿™è¯´æ˜Ž `a` å’Œ `b` å¼•ç”¨çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚

---

## âœ… äºŒã€æµ…æ‹·è´ vs æ·±æ‹·è´

| æ‹·è´æ–¹å¼ | æ˜¯å¦æ‹·è´åµŒå¥—å¯¹è±¡ | æ˜¯å¦å…±äº«å¼•ç”¨ | åœºæ™¯             |
| ---- | -------- | ------ | -------------- |
| æµ…æ‹·è´  | âŒ ä»…æ‹·è´ä¸€å±‚  | âœ… æ˜¯    | å¿«é€Ÿæ‹·è´ä¸€å±‚ç»“æž„       |
| æ·±æ‹·è´  | âœ… å…¨éƒ¨é€’å½’æ‹·è´ | âŒ å¦    | ä¿è¯æ•°æ®ç‹¬ç«‹ï¼Œé€‚ç”¨äºŽå¤æ‚å¯¹è±¡ |

---

## ðŸ” ä¸‰ã€æµ…æ‹·è´çš„æ–¹æ³•ï¼ˆåªæ‹·è´ç¬¬ä¸€å±‚ï¼‰

```js
const obj = { a: 1, b: { c: 2 } };

// æ–¹æ³• 1ï¼šObject.assign
const shallow1 = Object.assign({}, obj);

// æ–¹æ³• 2ï¼šå±•å¼€è¿ç®—ç¬¦
const shallow2 = { ...obj };
```

> ä¿®æ”¹ `shallow1.b.c = 3` ä¼šå½±å“ `obj.b.c`ï¼Œå› ä¸º `b` æ˜¯å…±äº«å¼•ç”¨ã€‚

---

## ðŸ§¬ å››ã€æ·±æ‹·è´çš„å®žçŽ°æ–¹å¼

### âœ… æ–¹æ³• 1ï¼šJSON åºåˆ—åŒ–ï¼ˆé™åˆ¶å¤šï¼‰

```js
const deep = JSON.parse(JSON.stringify(obj));
```

**ç¼ºç‚¹ï¼š**

* ä¼šå¿½ç•¥ `undefined` / `symbol` / `function`
* æ— æ³•å¤„ç†å¾ªçŽ¯å¼•ç”¨ã€RegExpã€Dateã€Mapã€Set ç­‰ç±»åž‹

---

### âœ… æ–¹æ³• 2ï¼šé€’å½’å®žçŽ°ï¼ˆåŸºç¡€å†™æ³•ï¼‰

```js
function deepClone(obj) {
  if (obj === null || typeof obj !== 'object') return obj;

  const result = Array.isArray(obj) ? [] : {};
  for (let key in obj) {
    if (obj.hasOwnProperty(key)) {
      result[key] = deepClone(obj[key]);
    }
  }
  return result;
}
```

---

### âœ… æ–¹æ³• 3ï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼ˆæŽ¨èï¼‰

* [`lodash.cloneDeep`](https://lodash.com/docs/4.17.15#cloneDeep)

```js
import cloneDeep from 'lodash/cloneDeep';
const deep = cloneDeep(obj);
```

---

## ðŸ§  æ€»ç»“å›¾ç¤ºï¼ˆå†…å­˜ç»“æž„ + æ‹·è´ï¼‰

```
+---------------------+       +-------------------+
|     Stackï¼ˆæ ˆï¼‰      |       |     Heapï¼ˆå †ï¼‰      |
|---------------------|       |-------------------|
| name ---> "Vue"     |       |                   |
| obj ---> åœ°å€ ------|-----> | { name: "Vue" }   |
| shallow ---> åœ°å€ --|-----> | { name: "Vue" }   |
| deep ---> æ–°åœ°å€ ---|-----> | { name: "Vue" }   |
+---------------------+       +-------------------+
```

---