### 闭包

闭包： 一个函数和对其周围状态（lexical environment，词法环境）的引用捆绑在一起（或者说函数被引 用包围）， 这样的组合就是闭包（closure）。

也就是说，闭包让你可以在一个内层函数中访问到其外 层函数的作用域。在 JavaScript 中，每当创建一个函数，闭包就会在函数创建的同时被创建出来。

###  闭包的特点

-  让外部访问函数的内部变量成为可能； 
- 可以避免使用全局变量，防止全局变量污染； 
- 可以让局部变量常驻在内存中；
-  会造成内存泄漏（有一块内存空间被长期占用，而不被释放）；

### 应用场景

1. 埋点（网站分析的一种常用的数据采集方法）计数器

   ``` 
   function count() {
   var num = 0;
   return function () {
   return ++num;
   	}
   }
   var getNum = count();
   var getNewNum = count();
   document.querySelectorAll('button')[0].onclick = function(){
   console.log('点击加入购物车次数： '+getNum());
   }
   document.querySelectorAll('button')[1].onclick = function(){
   console.log('点击付款次数： '+getNewNum());
   }
   ```

2. 事件+循环

   按照以下方式添加事件，打印出来的i不是按照序号的 形成原因就是操作的是同一个词法环境,因为onclick后面的函数都是一个闭包，但是操作的是同一个词 法环境

   ``` 
   var lis = document.querySelectorAll('li');
   for (var i = 0; i < lis.length; i++) {
   lis[i].onclick = function () {
   alert(i)
   	}
   }
   ```

   解决办法： 使用匿名函数之后，就形成一个闭包， 操作的就是不同的词法环境

   ``` 
   var lis = document.querySelectorAll('li');
   for (var i = 0; i < lis.length; i++) {
   (function (j) {
   lis[j].onclick = function () {
   alert(j)
   	}
     })(i)
   }
   ```

   